<!-- Vulnerability Identification -->
<div class="response-feature animate-slideInLeft delay-4">
    <div class="feature-content">
        <h3>Vulnerability Identification</h3>
        <p>Not sure where to start? We can help triage and identify suspected software vulnerabilities, accelerating the pursuit of mitigation and remediation.</p>
    </div>
    <div class="feature-animation">
        <svg class="code-analysis-svg" viewBox="0 0 900 750" xmlns="http://www.w3.org/2000/svg">
            <!-- Code Editor Container -->
            <defs>
                <linearGradient id="editorGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#1e293b;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#0f172a;stop-opacity:1" />
                </linearGradient>
            </defs>
            
            <!-- Editor Window -->
            <rect x="0" y="0" width="900" height="750" rx="12" fill="url(#editorGradient)" stroke="#64748b" stroke-width="3"/>
            
            <!-- Editor Header -->
            <rect x="30" y="30" width="840" height="50" rx="12" fill="#0f172a" stroke="#334155" stroke-width="2"/>
            <circle cx="60" cy="55" r="9" fill="#ef4444"/>
            <circle cx="82" cy="55" r="9" fill="#fbbf24"/>
            <circle cx="104" cy="55" r="9" fill="#22c55e"/>
            <text x="135" y="62" font-family="Monaco, monospace" font-size="16" fill="#cbd5e1">AuthController.java</text>
            
            <!-- Line Numbers -->
            <g class="line-numbers">
                <text x="68" y="105" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">1</text>
                <text x="68" y="128" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">2</text>
                <text x="68" y="151" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">3</text>
                <text x="68" y="174" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">4</text>
                <text x="68" y="197" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">5</text>
                <text x="68" y="220" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">6</text>
                <text x="68" y="243" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">7</text>
                <text x="68" y="266" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">8</text>
                <text x="68" y="289" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">9</text>
                <text x="68" y="312" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">10</text>
                <text x="68" y="335" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">11</text>
                <text x="68" y="358" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">12</text>
                <text x="68" y="381" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">13</text>
                <text x="68" y="404" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">14</text>
                <text x="68" y="427" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">15</text>
                <text x="68" y="450" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">16</text>
                <text x="68" y="473" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">17</text>
                <text x="68" y="496" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">18</text>
                <text x="68" y="519" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">19</text>
                <text x="68" y="542" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">20</text>
                <text x="68" y="565" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">21</text>
                <text x="68" y="588" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">22</text>
                <text x="68" y="611" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">23</text>
                <text x="68" y="634" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">24</text>
                <text x="68" y="657" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">25</text>
                <text x="68" y="680" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">26</text>
                <text x="68" y="703" font-family="Monaco, monospace" font-size="14" fill="#64748b" text-anchor="end">27</text>
            </g>
            
            <!-- Complete Code Content -->
            <g class="code-content fade-in-code" style="animation-delay: 0.5s">
                <text x="83" y="105" font-family="Monaco, monospace" font-size="14" fill="#94a3b8">@RestController</text>
                <text x="83" y="128" font-family="Monaco, monospace" font-size="14" fill="#94a3b8">@RequestMapping("/api/auth")</text>
                <text x="83" y="151" font-family="Monaco, monospace" font-size="14" fill="#22c55e">public class </text>
                <text x="188" y="151" font-family="Monaco, monospace" font-size="14" fill="#60a5fa">AuthController {</text>
                <text x="83" y="174" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1"></text>
                <text x="105" y="197" font-family="Monaco, monospace" font-size="14" fill="#94a3b8">@Autowired</text>
                <text x="105" y="220" font-family="Monaco, monospace" font-size="14" fill="#22c55e">private </text>
                <text x="173" y="220" font-family="Monaco, monospace" font-size="14" fill="#60a5fa">DatabaseService </text>
                <text x="303" y="220" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">dbService;</text>
                <text x="83" y="243" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1"></text>
                
                <text x="105" y="266" font-family="Monaco, monospace" font-size="14" fill="#94a3b8">@PostMapping("/login")</text>
                <text x="105" y="289" font-family="Monaco, monospace" font-size="14" fill="#22c55e">public </text>
                <text x="165" y="289" font-family="Monaco, monospace" font-size="14" fill="#60a5fa">ResponseEntity</text>
                <text x="285" y="289" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">&lt;String&gt; login(</text>
                <text x="128" y="312" font-family="Monaco, monospace" font-size="14" fill="#94a3b8">@RequestParam </text>
                <text x="243" y="312" font-family="Monaco, monospace" font-size="14" fill="#60a5fa">String</text>
                <text x="300" y="312" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">username,</text>
                <text x="128" y="335" font-family="Monaco, monospace" font-size="14" fill="#94a3b8">@RequestParam </text>
                <text x="243" y="335" font-family="Monaco, monospace" font-size="14" fill="#60a5fa">String</text>
                <text x="300" y="335" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">password) {</text>
                <text x="105" y="358" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1"></text>
                <text x="128" y="381" font-family="Monaco, monospace" font-size="14" fill="#60a5fa">String </text>
                <text x="188" y="381" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">hashedPassword = hashPassword(password);</text>
                <text x="105" y="404" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1"></text>
                <text x="128" y="427" font-family="Monaco, monospace" font-size="14" fill="#60a5fa">String </text>
                <text x="188" y="427" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">query = </text>
                <text x="248" y="427" font-family="Monaco, monospace" font-size="14" fill="#a78bfa">"SELECT id FROM users WHERE username='"</text>
                <text x="240" y="450" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">+ username +</text>
                <text x="345" y="450" font-family="Monaco, monospace" font-size="14" fill="#a78bfa">"' AND password_hash='"</text>
                <text x="240" y="473" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">+ hashedPassword +</text>
                <text x="393" y="473" font-family="Monaco, monospace" font-size="14" fill="#a78bfa">"'"</text>
                <text x="417" y="473" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">;</text>
                <text x="105" y="496" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1"></text>
                <text x="128" y="519" font-family="Monaco, monospace" font-size="14" fill="#60a5fa">ResultSet</text>
                <text x="210" y="519" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">result = dbService.executeQuery(query);</text>
                <text x="128" y="542" font-family="Monaco, monospace" font-size="14" fill="#22c55e">if </text>
                <text x="150" y="542" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">(result.next()) {</text>
                <text x="150" y="565" font-family="Monaco, monospace" font-size="14" fill="#60a5fa">String </text>
                <text x="210" y="565" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">userId = result.getString("id");</text>
                <text x="150" y="588" font-family="Monaco, monospace" font-size="14" fill="#60a5fa">String </text>
                <text x="210" y="588" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">token = generateSessionToken(userId);</text>
                <text x="150" y="611" font-family="Monaco, monospace" font-size="14" fill="#22c55e">return </text>
                <text x="210" y="611" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">ResponseEntity.ok(token);</text>
                <text x="128" y="634" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">} </text>
                <text x="143" y="634" font-family="Monaco, monospace" font-size="14" fill="#22c55e">else </text>
                <text x="180" y="634" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">{</text>
                <text x="150" y="657" font-family="Monaco, monospace" font-size="14" fill="#22c55e">return </text>
                <text x="210" y="657" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">ResponseEntity.status(401).body(</text>
                <text x="470" y="657" font-family="Monaco, monospace" font-size="14" fill="#a78bfa">"Unauthorized"</text>
                <text x="583" y="657" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">);</text>
                <text x="128" y="680" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">}</text>
                <text x="105" y="703" font-family="Monaco, monospace" font-size="14" fill="#cbd5e1">}</text>
            </g>
            
            <!-- Vulnerability Highlighting -->
            <g class="vulnerability-highlight">
                <!-- Red highlight background for vulnerable lines -->
                <rect x="75" y="410" width="795" height="79" rx="5" fill="#ef4444" fill-opacity="0.2" stroke="#ef4444" stroke-width="3" class="highlight-vulnerable">
                    <animate attributeName="fill-opacity" values="0.2;0.5;0.2" dur="2s" repeatCount="indefinite" begin="1.5s"/>
                    <animate attributeName="stroke-opacity" values="1;0.6;1" dur="2s" repeatCount="indefinite" begin="1.5s"/>
                </rect>
                
                <!-- Warning icon -->
                <circle cx="840" cy="450" r="15" fill="#ef4444" class="warning-icon" opacity="0">
                    <animate attributeName="opacity" values="0;1" dur="0.5s" begin="1.5s" fill="freeze"/>
                </circle>
                <text x="840" y="457" font-family="system-ui" font-size="12" fill="#fff" text-anchor="middle" class="warning-icon" opacity="0">!
                    <animate attributeName="opacity" values="0;1" dur="0.5s" begin="1.5s" fill="freeze"/>
                </text>
            </g>
            
            <!-- Analysis Panel -->
            <g class="analysis-panel" style="animation: slide-up-analysis 0.8s ease-out 2.5s forwards; opacity: 0;">
                <rect x="60" y="670" width="780" height="60" rx="9" fill="#0c1420" stroke="#ef4444" stroke-width="3"/>
                <text x="75" y="690" font-family="system-ui" font-size="15" fill="#ef4444" font-weight="600">âš  SQL Injection Vulnerability Detected</text>
                <text x="75" y="705" font-family="system-ui" font-size="12" fill="#cbd5e1">Lines 15-17: Direct string concatenation allows injection attacks</text>
                <text x="75" y="720" font-family="system-ui" font-size="12" fill="#cbd5e1">Recommendation: Use parameterized queries</text>
            </g>
        </svg>
    </div>
</div> 