<!-- Resolution Verification -->
<div class="response-feature animate-slideInRight delay-5">
    <div class="feature-animation">
        <svg class="verification-svg" viewBox="0 0 900 675" xmlns="http://www.w3.org/2000/svg">
            <!-- Git Diff Container -->
            <rect x="2" y="2" width="896" height="671" rx="18" fill="#1e293b" stroke="rgb(147, 197, 253)" stroke-width="3"/>
            
            <!-- Git Diff Header -->
            <g class="diff-header fade-in-verification" style="animation-delay: 0.5s">
                <rect x="30" y="30" width="840" height="70" rx="12" fill="#0f172a" stroke="#334155" stroke-width="2"/>
                <text x="50" y="58" font-family="Monaco, monospace" font-size="18" fill="#f1f5f9" font-weight="600">git diff AuthController.java</text>
                <text x="50" y="85" font-family="Monaco, monospace" font-size="16" fill="#94a3b8">@@ -13,6 +13,15 @@ public class AuthController {</text>
            </g>
            
            <!-- Old Code (Removed) -->
            <g class="old-code fade-in-verification" style="animation-delay: 1.0s">
                <text x="50" y="130" font-family="Monaco, monospace" font-size="16" fill="#94a3b8">13</text>
                <text x="95" y="130" font-family="Monaco, monospace" font-size="16" fill="#cbd5e1">        String hashedPassword = hashPassword(password);</text>
                <text x="50" y="155" font-family="Monaco, monospace" font-size="16" fill="#94a3b8">14</text>
                
                <!-- Removed lines with red background -->
                <rect x="40" y="170" width="820" height="105" rx="8" fill="#ef4444" fill-opacity="0.1" stroke="#ef4444" stroke-width="3"/>
                <text x="50" y="195" font-family="Monaco, monospace" font-size="16" fill="#ef4444">-</text>
                <text x="80" y="195" font-family="Monaco, monospace" font-size="16" fill="#ef4444">15</text>
                <text x="125" y="195" font-family="Monaco, monospace" font-size="16" fill="#ef4444">String query = "SELECT id FROM users WHERE username='"</text>
                <text x="50" y="220" font-family="Monaco, monospace" font-size="16" fill="#ef4444">-</text>
                <text x="80" y="220" font-family="Monaco, monospace" font-size="16" fill="#ef4444">16</text>
                <text x="245" y="220" font-family="Monaco, monospace" font-size="16" fill="#ef4444">+ username + "' AND password_hash='"</text>
                <text x="50" y="245" font-family="Monaco, monospace" font-size="16" fill="#ef4444">-</text>
                <text x="80" y="245" font-family="Monaco, monospace" font-size="16" fill="#ef4444">17</text>
                <text x="245" y="245" font-family="Monaco, monospace" font-size="16" fill="#ef4444">+ hashedPassword + "'";</text>
            </g>
            
            <!-- New Code (Added) -->
            <g class="new-code fade-in-verification" style="animation-delay: 1.5s">
                <!-- Added lines with green background -->
                <rect x="40" y="290" width="820" height="240" rx="8" fill="#22c55e" fill-opacity="0.1" stroke="#22c55e" stroke-width="3"/>
                <text x="50" y="315" font-family="Monaco, monospace" font-size="16" fill="#22c55e">+</text>
                <text x="80" y="315" font-family="Monaco, monospace" font-size="16" fill="#22c55e">15</text>
                <text x="125" y="315" font-family="Monaco, monospace" font-size="16" fill="#22c55e">// Secure implementation: retrieve hash by username first</text>
                <text x="50" y="340" font-family="Monaco, monospace" font-size="16" fill="#22c55e">+</text>
                <text x="80" y="340" font-family="Monaco, monospace" font-size="16" fill="#22c55e">16</text>
                <text x="125" y="340" font-family="Monaco, monospace" font-size="16" fill="#22c55e">String query = "SELECT id, password_hash FROM users WHERE username = ?";</text>
                <text x="50" y="365" font-family="Monaco, monospace" font-size="16" fill="#22c55e">+</text>
                <text x="80" y="365" font-family="Monaco, monospace" font-size="16" fill="#22c55e">17</text>
                <text x="125" y="365" font-family="Monaco, monospace" font-size="16" fill="#22c55e">PreparedStatement stmt = dbService.prepareStatement(query);</text>
                <text x="50" y="390" font-family="Monaco, monospace" font-size="16" fill="#22c55e">+</text>
                <text x="80" y="390" font-family="Monaco, monospace" font-size="16" fill="#22c55e">18</text>
                <text x="125" y="390" font-family="Monaco, monospace" font-size="16" fill="#22c55e">stmt.setString(1, username);</text>
                <text x="50" y="415" font-family="Monaco, monospace" font-size="16" fill="#22c55e">+</text>
                <text x="80" y="415" font-family="Monaco, monospace" font-size="16" fill="#22c55e">19</text>
                <text x="125" y="415" font-family="Monaco, monospace" font-size="16" fill="#22c55e">ResultSet result = stmt.executeQuery();</text>
                <text x="50" y="440" font-family="Monaco, monospace" font-size="16" fill="#22c55e">+</text>
                <text x="80" y="440" font-family="Monaco, monospace" font-size="16" fill="#22c55e">20</text>
                <text x="50" y="465" font-family="Monaco, monospace" font-size="16" fill="#22c55e">+</text>
                <text x="80" y="465" font-family="Monaco, monospace" font-size="16" fill="#22c55e">21</text>
                <text x="125" y="465" font-family="Monaco, monospace" font-size="16" fill="#22c55e">if (result.next()) {</text>
                <text x="50" y="490" font-family="Monaco, monospace" font-size="16" fill="#22c55e">+</text>
                <text x="80" y="490" font-family="Monaco, monospace" font-size="16" fill="#22c55e">22</text>
                <text x="155" y="490" font-family="Monaco, monospace" font-size="16" fill="#22c55e">String storedHash = result.getString("password_hash");</text>
            </g>
            
            <!-- Continuing Code -->
            <g class="continuing-code fade-in-verification" style="animation-delay: 2.0s">
                <!-- Modified section -->
                <rect x="40" y="545" width="820" height="100" rx="8" fill="#22c55e" fill-opacity="0.1" stroke="#22c55e" stroke-width="3"/>
                <text x="50" y="570" font-family="Monaco, monospace" font-size="16" fill="#22c55e">+</text>
                <text x="80" y="570" font-family="Monaco, monospace" font-size="16" fill="#22c55e">23</text>
                <text x="155" y="570" font-family="Monaco, monospace" font-size="16" fill="#22c55e">// Secure comparison of password hashes</text>
                <text x="50" y="595" font-family="Monaco, monospace" font-size="16" fill="#22c55e">+</text>
                <text x="80" y="595" font-family="Monaco, monospace" font-size="16" fill="#22c55e">24</text>
                <text x="155" y="595" font-family="Monaco, monospace" font-size="16" fill="#22c55e">if (secureCompare(storedHash, hashedPassword)) {</text>
                <text x="50" y="620" font-family="Monaco, monospace" font-size="16" fill="#22c55e">+</text>
                <text x="80" y="620" font-family="Monaco, monospace" font-size="16" fill="#22c55e">25</text>
                <text x="185" y="620" font-family="Monaco, monospace" font-size="16" fill="#22c55e">String userId = result.getString("id");</text>
            </g>
        </svg>
    </div>
    <div class="feature-content">
        <h3>Resolution Verification</h3>
        <p> When a mitigation or remediation is implemented, we can assess it for thoroughness and completness. </p>
    </div>
</div> 